<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" >
<html xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head>
    <meta charset="UTF-8">
    <title>添加政策</title>
</head>
<script type="text/javascript" th:src="@{/layui/jquery-1.11.3.min.js}"></script>
<script type="text/javascript" th:src="@{/js/moment.js}"></script>
<script type="text/javascript" th:src="@{/UEditor/ueditor.config.js}"></script>
<script type="text/javascript" th:src="@{/UEditor/ueditor.all.js}"></script>
<script type="text/javascript" th:src="@{/UEditor/lang/zh-cn/zh-cn.js}"></script>
<!--<script type="text/html">-->
<!--<p id="uname" style="display: none"> {{ currentUser.username }} </p>-->
<!--</script>-->
<!--<script th:inline="javascript">-->
<!--var currentUser = [[${user}]];-->
<!--console.log(currentUser)-->
<!--</script>-->
<style>
    input{
        margin-top: 20px;
        width: 392px;
        height: 18px;
    }
    select{
        margin-top: 20px;
        width: 400px;
        height: 30px;
    }
</style>
<body>

<div class="layui-fluid layui-anim febs-anim" id="febs-dept" lay-title="政策录入">
    <div class="layui-col-md12 layui-col-sm12 layui-col-xs12" >
        <div class="layui-card">
            <form action='Enter/add' method='post' id='form' onsubmit='return check()'>
                <div style='margin-top: 20px;margin-right: 30px'>

                    <div class='layui-form-item' style="display: none">
                        <label class='layui-form-label' >发布人</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text'  id='publisher' name='publisher' value=''>
                        </div></div>

                    <div class='layui-form-item' >
                        <label class='layui-form-label'>政策名称</label>
                        <div class='layui-input-block' >
                            <input class='layui-input' type='text' name='name' id='name'>
                        </div></div>

                    <div class='layui-form-item'>
                        <label class='layui-form-label'>发文字号</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='documentId' id='documentId'></div></div>

                    <div class='layui-form-item'>
                        <label class='layui-form-label'>政策分类</label>
                        <div class='layui-input-block'>
                            <select tabindex="4"  class="layui-input"  name='documentType' id='documentType'>
                                <option disabled   style="display: none" selected>请选择</option>
                                <option value="综合">综合</option>
                                <option value="科研机构改革">科研机构改革</option>
                                <option value="科技计划管理">科技计划管理</option>
                                <option value="科技经费与财务">科技经费与财务</option>
                                <option value="基础研究与科研基地">基础研究与科研基地</option>
                                <optgroup label="基础研究与科研基地（细分）">
                                    <option value="基础研究">基础研究</option>
                                    <option value="平台基地">平台基地</option>
                                </optgroup>
                                <optgroup label="">
                                </optgroup>
                                <option value="企业技术进步与高新技术产业化">企业技术进步与高新技术产业化</option>
                                <optgroup label="企业技术进步与高新技术产业化（细分）">
                                    <option value="企业">企业</option>
                                    <option value="产业">产业</option>
                                    <option value="创新载体">创新载体</option>
                                </optgroup>
                                <optgroup label="">
                                </optgroup>
                                <option value="农村科技与社会发展">农村科技与社会发展</option>
                                <option value="科技人才">科技人才</option>
                                <option value="科技中介服务">科技中介服务</option>
                                <option value="科技条件与标准">科技条件与标准</option>
                                <option value="科技金融与税收">科技金融与税收</option>
                                <option value="科技成果与知识产权">科技成果与知识产权</option>
                                <option value="科技奖励">科技奖励</option>
                                <option value="科学技术普及">科学技术普及</option>
                                <option value="国际科技合作">国际科技合作</option>
                            </select>
                        </div></div>

                    <div class='layui-form-item'>
                        <label class='layui-form-label'>施行范围</label>
                        <div class='layui-input-block'>
                            <select name="documentArea" id="documentArea" tabindex="4"  class="layui-input">
                                <option disabled   style="display: none" selected>请选择</option>
                                <option value="全国（000000 QG）">全国</option>
                                <optgroup label="地方（各省、市、自治区）">
                                    <option value="北京市（110000 BJ）">北京市</option>
                                    <option value="天津市（120000 TJ）">天津市</option>
                                    <option value="河北省（130000 HE）">河北省</option>
                                    <option value="山西省（140000 SX）">山西省</option>
                                    <option value="内蒙古自治区（150000 NM）">内蒙古自治区</option>
                                    <option value="辽宁省（210000 LN）">辽宁省</option>
                                    <option value="吉林省（220000 JL）">吉林省</option>
                                    <option value="黑龙江省（230000 HL）">黑龙江省</option>
                                    <option value="上海市（310000 SH）">上海市</option>
                                    <option value="江苏省（320000 JS）">江苏省</option>
                                    <option value="浙江省（330000 ZJ）">浙江省</option>
                                    <option value="安徽省（340000 AH）">安徽省</option>
                                    <option value="福建省（350000 FJ）">福建省</option>
                                    <option value="江西省（360000 JX）">江西省</option>
                                    <option value="山东省（370000 SD）">山东省</option>
                                    <option value="河南省（410000 HA）">河南省</option>
                                    <option value="湖北省（420000 HB）">湖北省</option>
                                    <option value="湖南省（430000 HN）">湖南省</option>
                                    <option value="广东省（440000 GD）">广东省</option>
                                    <option value="广西壮族自治区（450000 GX）">广西壮族自治区</option>
                                    <option value="海南省（460000 HI）">海南省</option>
                                    <option value="重庆市（500000 CQ）">重庆市</option>
                                    <option value="四川省（510000 SC）">四川省</option>
                                    <option value="贵州省（520000 GZ）">贵州省</option>
                                    <option value="云南省（530000 YN）">云南省</option>
                                    <option value="西藏自治区（540000 XZ）">西藏自治区</option>
                                    <option value="陕西省（610000 SN）">陕西省</option>
                                    <option value="甘肃省（620000 GS）">甘肃省</option>
                                    <option value="青海省（630000 QH）">青海省</option>
                                    <option value="宁夏回族自治区（640000 NX）">宁夏回族自治区</option>
                                    <option value="新疆维吾尔自治区（650000 XJ）">新疆维吾尔自治区</option>
                                    <option value="台湾省（710000 Tw）">台湾省</option>\
                                    <option value="香港特别行政区（810000 HK）">香港特别行政区</option>
                                    <option value="澳门特别行政区（820000 MO）">澳门特别行政区</option>
                                </optgroup>
                            </select></div></div>

                    <div class='layui-form-item' style="display: none">
                        <label class='layui-form-label'>颁布形式</label>
                        <div class='layui-input-block'>
                            <select class='layui-input'  name='publishType' id='publishType'>
                                <option  disabled   style="display: none"  selected>请选择</option>
                                <option value="国家主席令（法律）">国家主席令（法律）</option>
                                <option value="国务院令（行政法规）" selected = "selected">国务院令（行政法规）</option>
                                <option value="地方人民代表大会主席团或者常务委员会公告（地方性法规）">地方人民代表大会主席团或者常务委员会公告（地方性法规）</option>
                                <option value="部门首长令（部门规章）">部门首长令（部门规章）</option>
                                <option value="地方首长令（地方政府规章）">地方首长令（地方政府规章）</option>
                                <option value="下发文件（非立法性文件）">下发文件（非立法性文件）</option>
                            </select>
                        </div></div>

                    <div class='layui-form-item'>
                        <label class='layui-form-label'>发文机构</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='organ' id='organ'></div></div>

                    <div class='layui-form-item'>
                        <label class='layui-form-label'>发文日期</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='passDate' id='passDate' value='' ></div></div>
                    <script>
                        layui.use('laydate', function(){
                            var laydate = layui.laydate;
                            //日期范围
                            laydate.render({
                                elem: '#passDate'
                                ,range: false
                                ,format:'yyyy.MM.dd'
                            });
                        });
                    </script>
                    <div class='layui-form-item' style="display: none">
                        <label class='layui-form-label'>录入日期</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='publishDate' id='publishDate' value="">
                        </div>
                    </div>

                    <div  class='layui-form-item'>
                        <label class='layui-form-label'>施行日期</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='exeDate' id='exeDate' value='' ></div></div>
                    <script>
                        layui.use('laydate', function(){
                            var laydate = layui.laydate;
                            //日期范围
                            laydate.render({
                                elem: '#exeDate'
                                ,range: false
                                ,format:'yyyy.MM.dd'
                            });
                        });
                    </script>
                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>调整领域</label>
                        <div class='layui-input-block'>
                            <select class='layui-input'  name='documentTarget' id='documentTarget'>
                                <option disabled  style="display: none" selected>请选择</option>
                                <option value="科技投入">科技投入</option>
                                <option value="税收激励">税收激励</option>
                                <option value="金融支持">金融支持</option>
                                <option value="政府采购">政府采购</option>
                                <option value="引进消化吸收再创新">引进消化吸收再创新</option>
                                <option value="人才队伍">人才队伍</option>
                                <option value="教育与科普">教育与科普</option>
                                <option value="科技创新基地与平台">科技创新基地与平台</option>
                                <option value="加强统筹协调">加强统筹协调</option>
                                <option value="其他" selected = "selected">其他</option>
                            </select>
                        </div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>主题词</label>
                        <div class='layui-input-block'>
                            <input placeholder='3 ~ 5 个' class='layui-input' type='text' name='themeWords' id='themeWords' value=''></div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>关键词</label>
                        <div class='layui-input-block'>
                            <input placeholder='5 ~ 10 个' class='layui-input' type='text' name='keyWords' id='keyWords' value=''></div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>上位政策</label>"
                        <div class='layui-input-block'>"
                            <input  class='layui-input' type='text' name='upDocument' id='upDocument' value=''></div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>前驱政策</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='preDocument' id='preDocument' value=''></div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>后继政策</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='postDocument' id='postDocument' value=''></div></div>

                    <div style="display: none" class="layui-form-item">
                        <label class="layui-form-label">时效状态</label>
                        <div class="layui-input-block" style='font-size: 14px'>
                            <input type="radio" name="documentState" id="documentState" value="有效" title="有效">有效<br>
                            <input type="radio" name="documentState" id="documentState" value="" title="有效" checked='checked'><br>
                            <input type="radio" name="documentState" id="documentState" value="失效" title="失效">失效
                        </div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>冗余字段</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='surField' id='surField' value=''></div></div>


                    <div class='layui-form-item'>
                        <label class="layui-form-label">政策内容</label>
                        <div class="layui-input-block">
                            <textarea id='text' name='text' ></textarea>
                        </div></div>

                    <div style="display: none" class='layui-form-item'>
                        <label class='layui-form-label'>标引状态</label>
                        <div class='layui-input-block'>
                            <input class='layui-input' type='text' name='indexState' id='indexState' value='待标引'></div></div>

                    <div class='layui-form-item' >
                        <div class='layui-input-block'>
                            <input  style='margin-top: 20px' class='layui-input layui-btn layui-btn-sm' type='submit' value='提交' ></div></div>

                </div></form>

            <script>
                function check() {
                    let name = document.getElementById('name').value;if(name.length==0){alert('政策名称不能为空！');return false;}
                    let organ = document.getElementById('organ').value;if(organ.length==0){alert('发文机构不能为空！');return false;}
                    // let publish_date = document.getElementById('publishDate').value;if(publish_date.length==0){alert('录入日期不能为空！');return false;}
                    var currentTime=moment().format('YYYY.MM.DD');
                    // var year=time.getFullYear();
                    // var month=time.getMonth();
                    // var date=time.getDate();
                    // var day=time.getDay();
                    // var hour=time.getHours();
                    // var minu=time.getMinutes();
                    // alert("现在是"+currentTime);
                    document.getElementById('publishDate').value=currentTime

                    var html = ue.getContent();
                    document.getElementById("text").value = html;
                    // console.log("正文部分： "+document.getElementById('text').value)
                    // alert("正文部分： "+document.getElementById('text').value)
                    // return false;
                }
            </script>

            <script>
                var server_url = window.location.hostname;
                //alert(server_url);
                var name="";
                if(server_url=="10.1.10.148"){
                    name="/science-2.0"
                }
                if(document.getElementById('text')!=null){
                    // var ue = UE.getEditor('text');
                    // $(function() {

                    var ue = UE.getEditor('text');

                    // 手动指定上传文件调用的接口（不同文件类型不同接口）
                    UE.Editor.prototype._bkGetActionUrl = UE.Editor.prototype.getActionUrl;
                    UE.Editor.prototype.getActionUrl = function(action) {
                        // 这里很重要，很重要，很重要，要和配置中的imageActionName值一样
                        if(action == 'uploadimage'){
                            // 这里调用后端我们写的图片上传接口
                            return name+'/api/ueditor/uploadimage';
                        }else if(action == 'uploadfile'){
                            return name+'/api/ueditor/uploadfile';
                        }else{
                            return this._bkGetActionUrl.call(this, action);
                        }
                    }
                    ue.ready(function() {
                        ue.setHeight(400);
                        //
                        //     // editor.execCommand('fontfamily','宋体'); //字体
                        //     // editor.execCommand('lineheight', 1.5); //行间距
                        //     // editor.execCommand('fontsize', '12px'); //字号
                    })
                    // });


                }

            </script>
            <!--<script>-->
            <!--let name = $("#uname").text().trim();-->
            <!--document.getElementById('publisher').value=name-->
            <!--</script>-->
            <!--<script>-->
            <!---->
            <!--document.getElementById('publishDate').value=name-->
            <!--</script>-->
        </div>
    </div>
</div>
</body>
</html>